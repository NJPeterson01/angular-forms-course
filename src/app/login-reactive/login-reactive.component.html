<!--
  Reactive forms puts more emphasis on the typescript than the HTML.
  HTML should purely be for how the form looks and not how it works.
  Reactive also minimizes required directives to achieve desired goal.
-->

<!--
  formContrl -> Form control object
  formControlName -> From control inside form
-->
<mat-card class="login-page">
  <mat-card-title>Login (Reactive)</mat-card-title>
  <mat-card-content>
    <form class="login-form data-form" [formGroup]="form">
      <mat-form-field>
        <input
          matInput
          type="email"
          name="email"
          placeholder="Email"
          formControlName="email"
        />

        <mat-error *ngIf="email.errors?.required"
          >The email is mandatory</mat-error
        >

        <mat-error *ngIf="email.errors?.minlength">
          You email must be {{ email.errors?.minlength.requiredLength }} chars
          but it only has {{ email.errors?.minlength.actualLength }}.
        </mat-error>

        <mat-error *ngIf="email.errors?.email"
          >This is not a valid email</mat-error
        >
      </mat-form-field>

      <mat-form-field>
        <input
          matInput
          type="password"
          placeholder="Password"
          formControlName="password"
        />

        <mat-error *ngIf="password.errors?.required">
          Password cannot be empty!
        </mat-error>
      </mat-form-field>

      <ng-container
        *ngIf="
          password.errors
            | onlyOneError : ['minlength', 'passwordStrength'] as error
        "
      >
        <div class="field-message" *ngIf="error?.minlength">
          Email must be at least
          {{ error?.minlength.requiredLength }} characters
        </div>

        <div class="field-message" *ngIf="error?.passwordStrength">
          Your password must have an uppercase, lowercase, and numeric value!
        </div>
      </ng-container>

      <button mat-raised-button color="primary" [disabled]="!form.valid">
        Login
      </button>

      <button mat-raised-button color="primary" (click)="reset()">
        Reset
      </button>
    </form>

    <!-- Debugging -->
    <div class="form-val">
      {{ form.value | json }}
    </div>

    <div class="form-val">
      {{ form.valid }}
    </div>
  </mat-card-content>
</mat-card>
